# epoll_model_Linux
底层为红黑树在 Linux 内核中，epoll 的实现确实使用了红黑树数据结构来提高事件的管理效率。红黑树是一种自平衡的二叉查找树，具有较快的插入、删除和查找操作的时间复杂度。

在 epoll 的实现中，主要有以下几个关键的数据结构和算法：

红黑树：
epoll 使用红黑树来存储需要监听的文件描述符和事件。
通过红黑树的特性，可以快速查找和管理需要监听的文件描述符，提高事件管理的效率。
双链表：
除了红黑树，epoll 还使用了双链表来存储事件就绪的文件描述符。
当事件就绪时，内核将文件描述符从红黑树中移动到双链表中，以便应用程序能够快速访问就绪的事件。
事件表：
epoll 维护了一个事件表，其中包含红黑树和双链表等数据结构，用于管理事件的注册、删除和就绪通知。
通过使用红黑树等高效的数据结构，epoll 能够有效地处理大量的文件描述符和事件，提供高性能的 I/O 多路复用机制。红黑树的特性使得 epoll 在添加、查找和删除事件时具有较好的时间复杂度，有利于系统的扩展和性能优化。


在 Linux 系统下，常用的 I/O 多路复用机制是 epoll，它是一个高性能的事件通知接口，用于处理大量的文件描述符的 I/O 事件。epoll 通过系统调用实现，可以高效地管理大量的并发连接和事件。

而在 Windows 系统下，对应的高性能 I/O 多路复用机制是 I/O Completion Ports (IOCP)。IOCP 是 Windows 平台上用于高性能异步 I/O 完成通知的机制，适用于处理大量并发的 I/O 操作。









水平触发与边缘触发
水平触发(level-trggered)

只要文件描述符关联的读内核缓冲区非空，有数据可以读取，就一直发出可读信号进行通知，
当文件描述符关联的内核写缓冲区不满，有空间可以写入，就一直发出可写信号进行通知

边缘触发(edge-triggered)

当文件描述符关联的读内核缓冲区由空转化为非空的时候，则发出可读信号进行通知，
当文件描述符关联的内核写缓冲区由满转化为不满的时候，则发出可写信号进行通知

两者的区别？
水平触发是只要读缓冲区有数据，就会一直触发可读信号，而边缘触发仅仅在空变为非空的时候通知一次，举个例子：

读缓冲区刚开始是空的
读缓冲区写入2KB数据
水平触发和边缘触发模式此时都会发出可读信号
收到信号通知后，读取了1kb的数据，读缓冲区还剩余1KB数据
水平触发会再次进行通知，而边缘触发不会再进行通知

所以边缘触发需要一次性的把缓冲区的数据读完为止，也就是一直读，直到读到EGAIN(EGAIN说明缓冲区已经空了)为止，因为这一点，边缘触发需要设置文件句柄为非阻塞。

ET模式在很大程度上减少了epoll事件被重复触发的次数，因此效率要比LT模式高。epoll工作在ET模式的时候，必须使用非阻塞套接口，以避免由于一个文件句柄的阻塞读/阻塞写操作把处理多个文件描述符的任务饿死。

